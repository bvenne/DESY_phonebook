<!DOCTYPE html>
<html>
<head>
	<title>DESY phone book</title>
	<meta charset="utf-8">
	<meta name="format-detection" content="telephone=no" />
	<meta name="msapplication-tap-highlight" content="no" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
	<meta name="author" content="Bastian Vennemann">
	<script type="text/javascript" src="cordova.js"></script>
	<!-- CSS -->
	<link rel="stylesheet" href="https://wof-live.desy.de/sites/common4all/fonts/font-awesome/font-awesome-4.2.0/css/font-awesome.min.css" >
	<link rel="stylesheet" href="https://wof-live.desy.de/sites/desyphonebook/css/style.css" type="text/css" />
	<!--[if gte IE 9]>
		<style type="text/css">
			.gradient {
				filter: none;
			}
		</style>
	<![endif]-->
	<style>
		.fa-lg {
			font-size: 1.7em;
			line-height: .5em;
		}
		.contact-email, .contact-phone, .contact-info { width: 30px; }
		
		#loginPage {
			margin: 0 auto;
			padding: 2em;
			max-width: 600px;
			background-color: white;
			border: 1px solid #dfdfdf;
			box-shadow: 0 0 5px rgba(0,0,0,.05);
		}
		
		input[type='password'] { width: 96%; border: 1px solid #ccc; padding: 1em; }
		#username, #password { margin-bottom: 1em; }
	</style>
</head>

<body>
	
	


	
<div id="loginPage">
	<div>
		<h1>DESY Login</h1>
	</div>
	<div>
		<p id="hint">Zur Einrichtung des DESY Telefonbuchs muessen Sie sich einmalig einloggen.</p>
		<form id="loginForm">
			<div>
				<input type="text" name="username" id="username" value="" placeholder="Username" />
			</div>
			<div>
				<input type="password" name="password" id="password" value="" placeholder="Password" />
			</div>
			<input type="submit" value="Login" id="submitButton">
		</form>
	</div>
</div>
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	<div id="container" style="display:none;">
		<header>
			<h1>DESY Phone Book</h1>
		</header>
		<section id="search">
			<p id="hint">Search for contacts by typing in the field below:</p>
			<form action="" method="get" id="search-form">
				<input id="search-field" type="text" name="search" role="search" placeholder="Type the name of the contact here" autofocus />
			</form>
		</section>
		<section id="search-results" aria-atomic="true" aria-live="polite" aria-relevant="additions removals">
		</section>
	</div> <!-- End #container -->

	<!-- External JS -->
	<script type="text/javascript" charset="UTF-8" src="https://wof-live.desy.de/++resource++zms_/jquery/jquery-1.11.1.min.js"></script>

	<!-- Internal JS -->
	<script src="js/script.js" type="text/javascript"></script>
	<script type="text/javascript" src="js/index.js"></script>
	<script type="text/javascript">
		app.initialize();
	</script>
	
	<script>
	// courtest of stack overflow...
function make_base_auth(user, password) {
  var tok = user + ':' + password;
  var hash = btoa(tok);
  return "Basic " + hash;
}

$('#loginForm').submit(function(e) {
  e.preventDefault();
  
	var username = $("#username", this).val();
	var password = $("#password", this).val();

//    var salt = json["salt"];
//    var hash = hex_sha256($('#password').val());
//    var password = hex_hmac_sha256(salt, hash);

    $.ajax({
      url      : 'http://www.desy.de/~bvenne/sicher/',
      type     : 'GET',
      headers  : { Authorization: make_base_auth(username, password) },
      success  : function(){
        setTimeout(function() { alert("laeuft!!!"); $("#loginPage").hide(); $("#container").show(); }, 2000);
      },
      error    : function(){ alert("FEHLER BEIM LOGIN!!!"); console.log('error'); }
    });


});

	</script>
</body>
</html>
